#!/usr/bin/env bash

set -euo pipefail

XDG_CONFIG_HOME=${XDG_CONFIG_HOME:-"$HOME/.config"}

# files
GTK2_CONF="$XDG_CONFIG_HOME/gtk-2.0/gtkrc"
GTK3_CONF="$XDG_CONFIG_HOME/gtk-3.0/settings.ini"
GTK4_CONF="$XDG_CONFIG_HOME/gtk-4.0/settings.ini"
QT5_CONF="$XDG_CONFIG_HOME/qt5ct/qt5ct.conf"
QT6_CONF="$XDG_CONFIG_HOME/qt6ct/qt6ct.conf"

# loop over all file and check if they exist
for file in $GTK2_CONF $GTK3_CONF $GTK4_CONF $QT5_CONF $QT6_CONF; do
  if [ ! -f "$file" ]; then
    echo "file $file does not exist"
  fi
done



# data
read_kv() {
  local file="$1"
  local key="$2"

  [[ -f "$file" ]] || return 0
  awk -F= -v k="$key" '$1 ~ k {print $2}' "$file"
}

GTK2_THEME=$(read_kv "$GTK2_CONF" 'gtk-theme-name' | tr -d '"')
GTK2_ICON_THEME=$(read_kv "$GTK2_CONF" 'gtk-icon-theme-name' | tr -d '"')
GTK2_CURSOR_THEME=$(read_kv "$GTK2_CONF" 'gtk-cursor-theme-name' | tr -d '"')
GTK2_FONT=$(read_kv "$GTK2_CONF" 'gtk-font-name' | tr -d '"')

GTK3_THEME=$(read_kv "$GTK3_CONF" 'gtk-theme-name')
GTK3_ICON_THEME=$(read_kv "$GTK3_CONF" 'gtk-icon-theme')
GTK3_CURSOR_THEME=$(read_kv "$GTK3_CONF" 'gtk-cursor-theme-name')
GTK3_FONT=$(read_kv "$GTK3_CONF" 'gtk-font-name')

GTK4_THEME=$(read_kv "$GTK4_CONF" 'gtk-theme-name')
GTK4_ICON_THEME=$(read_kv "$GTK4_CONF" 'gtk-icon-theme')
GTK4_CURSOR_THEME=$(read_kv "$GTK4_CONF" 'gtk-cursor-theme-name')
GTK4_FONT=$(read_kv "$GTK4_CONF" 'gtk-font-name')

QT5_THEME=$(read_kv "$QT5_CONF" 'style')
QT5_ICON_THEME=$(read_kv "$QT5_CONF" 'icon_theme')
QT5_FONT_MONO=$(read_kv "$QT5_CONF" 'fixed' | tr -d '"' | awk -F, '{print $1,$2}')
QT5_FONT_REG=$(read_kv "$QT5_CONF" 'general' | tr -d '"' | awk -F, '{print $1,$2}')

QT6_THEME=$(read_kv "$QT6_CONF" 'style')
QT6_ICON_THEME=$(read_kv "$QT6_CONF" 'icon_theme')
QT6_FONT_MONO=$(read_kv "$QT6_CONF" 'fixed' | tr -d '"' | awk -F, '{print $1,$2}')
QT6_FONT_REG=$(read_kv "$QT6_CONF" 'general' | tr -d '"' | awk -F, '{print $1,$2}')

# print
echo "GTK2"
echo "Theme : $GTK2_THEME"
echo "Icon  : $GTK2_ICON_THEME"
echo "Cursor: $GTK2_CURSOR_THEME"
echo "Font  : $GTK2_FONT"
echo

echo "GTK3"
echo "Theme : $GTK3_THEME"
echo "Icon  : $GTK3_ICON_THEME"
echo "Cursor: $GTK3_CURSOR_THEME"
echo "Font  : $GTK3_FONT"
echo

echo "GTK4"
echo "Theme : $GTK4_THEME"
echo "Icon  : $GTK4_ICON_THEME"
echo "Cursor: $GTK4_CURSOR_THEME"
echo "Font  : $GTK4_FONT"
echo

echo "QT5"
echo "Icon  : $QT5_ICON_THEME"
echo "Font M: $QT5_FONT_MONO"
echo "Font R: $QT5_FONT_REG"
echo

echo "QT6"
echo "Icon  : $QT6_ICON_THEME"
echo "Font M: $QT6_FONT_MONO"
echo "Font R: $QT6_FONT_REG"
echo




# gsettings list-recursively org.gnome.desktop.interface
#
# gsettings set org.gnome.desktop.interface gtk-theme 'Adwaita-dark'
# gsettings set org.gnome.desktop.interface color-scheme 'prefer-dark'
# gsettings set org.gnome.desktop.interface icon-theme 'Reversal-dark'
